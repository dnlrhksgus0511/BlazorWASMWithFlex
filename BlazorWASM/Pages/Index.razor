@page "/"
@inject IJSRuntime JSRuntime;


    <body>
        <div style="width: 100%;">
            <label>No Argument Return</label>
            <div class="btn-group" role="group">
                <button class="btn btn-primary" @onclick="GetReturnString" type="button">String Return</button>
                <button class="btn btn-primary" @onclick="GetReturnObject" type="button">Object Return</button>
            </div>
            <div style="width: 100%;">
                <textarea @bind="ReturnValue" style="width: 100%;height: 200px;"></textarea>
            </div>
        </div>
    </body>
    @code {
        private string ReturnValue { get; set; }
        private string Argument { get; set; }
        private string ArgumentReturnValue { get; set; }
        public class ReturnObject
        {
            public string key { get; set; }
        }

        private async Task GetReturnString()
        {
            ReturnValue = await JSRuntime.InvokeAsync<string>("returnString");
        }
        private async Task GetReturnObject()
        {
            var a = await SomePromiseCall();
            ReturnValue = a;
        }

        private Task<string> SomePromiseCall()
        {
            var tcs = new TaskCompletionSource<string>();
            var promiseHandler = DotNetObjectReference.Create<PromiseHandler>(new PromiseHandler() { tcs = tcs });
            JSRuntime.InvokeAsync<object>("WithPromise", promiseHandler);

            return tcs.Task;
        }

        public class PromiseHandler
        {
            public TaskCompletionSource<string> tcs { get; set; }

            [JSInvokable]
            public void SetResult(string json)
            {
                tcs.SetResult(json);
            }
        }

    }
